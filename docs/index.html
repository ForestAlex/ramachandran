<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>MondeT Plot</title>
</head>
	
<body>
<script src="https://cdn.plot.ly/plotly-3.0.1.min.js"></script>
<h1>MondeT Plot </h1>
 <p>"Mond" is the German equivalent to the meaning of the surname Ramachandran. The Ramachandran plot translates to moon plot. The dihedral angels ϕ (phi) vs. ψ (psi), which are free angles of rotation of an amino acid in a protein backbone, can be plotted in a Ramachandran plot. The peptide bond angle w (omega) is restricted to mostly 180° due to the partial double-bond nature of the peptide connection. Three regions in the Ramachandran are often populated: The top left with β-strands and sheets, the bottom left with left-handed α-helices and the right middle with right-handed α-helices. The β-population is dominated by electrostatic forces, while the α-regions are preferred due to sterical benefit.    
</p>
<p>Play around with your favourite canonical amino acid background! Then, you can choose non-canonical amino acid candidates and compare their populated regions across structures. Do they explore novel parts of the fold landscapes? As an alternative mode, you can focus on only one structure. Play around how the fold from N-terminus to C-terminus spot by spot places the amino acids in backbone folds.</p>

<!-- Selection for IDs-->
  <input type="dropdown" list="list_ncaa" name="ncaa" id="ncaa" placeholder="Amino Acid ID">
  <datalist id="list_ncaa">
	<option value="YRV"><option value="3WX"><option value="FTR">
	<option value="ALC"><option value="200">
	<option value="HRG"><option value="NLE"><option value="OIC">
	<option value="WEH">
	<option value="WET">
	<option value="W4T">
	<option value="CRO">
	<option value="2TL">
	<option value="DSG">
	<option value="DSN">
	<option value="DAL">
	<option value="HTN">
	<option value="HVA">
	<option value="I2M">
	<option value="LMQ">
	<option value="M2S">
	<option value="MHE">
	<option value="DHV">
	<option value="MND">
	<option value="TBG">
	<option value="TDD">
  </datalist>

  <input type="dropdown" list="list_pdb" name="pdb" id="pdb" placeholder="PDB ID">
  <datalist id="list_pdb">
	<option value="6XIB">
	<option value="3Q4K">
	<option value="5VBL">
	<option value="8WM0">
	<option value="8OVY">
	<option value="2RQO">
  </datalist>
<!-- Checkboxes for canonical amino acids. Images to load faster.-->
<div id="canonical-checkboxes">
	<input type="checkbox" name="canonical_bg" value="ALL"> All amino acids
	<input type="checkbox" name="canonical_bg" value="ALA"> ALA
	<input type="checkbox" name="canonical_bg" value="ARG"> ARG
	<input type="checkbox" name="canonical_bg" value="ASN"> ASN
	<input type="checkbox" name="canonical_bg" value="ASP"> ASP
	<input type="checkbox" name="canonical_bg" value="CYS"> CYS
	<input type="checkbox" name="canonical_bg" value="GLN"> GLN
	<input type="checkbox" name="canonical_bg" value="GLU"> GLU
	<input type="checkbox" name="canonical_bg" value="GLY"> GLY
	<input type="checkbox" name="canonical_bg" value="HIS"> HIS
	<input type="checkbox" name="canonical_bg" value="ILE"> ILE
	<input type="checkbox" name="canonical_bg" value="LEU"> LEU
	<input type="checkbox" name="canonical_bg" value="LYS"> LYS
	<input type="checkbox" name="canonical_bg" value="MET"> MET
	<input type="checkbox" name="canonical_bg" value="PHE"> PHE
	<input type="checkbox" name="canonical_bg" value="PRO"> PRO
	<input type="checkbox" name="canonical_bg" value="SER"> SER
	<input type="checkbox" name="canonical_bg" value="THR"> THR
	<input type="checkbox" name="canonical_bg" value="TYR"> TYR
	<input type="checkbox" name="canonical_bg" value="TRP"> TRP
	<input type="checkbox" name="canonical_bg" value="VAL"> VAL
</div>

<input type="range" id="slider">
  <span id="slider-value">1</span>

  <div id="plot"></div>
  <script>
    // Beispiel-Daten
    const phi = [0, 0, -2.528198591698414, -1.4536066260808096, 1.0264276272945738, -1.3955514258894455, -1.9506775387560011, -2.1011683638335845, -1.5709094728323638, -1.4203386381998349, -2.6333256134736613, -2.180181932623965, -1.2353928986831069, -1.1906401279328185, -1.7047802705003796, 1.290698419790252, -1.3193394081612264, -2.77170891618575, -2.289721152434155, -2.0769771431465522, -2.0191581974504897, -2.224432176890272, -1.566603790966023, -1.5933103179236423, -1.7679827348203514, -1.7265719041780854, -2.1070315384329725, -1.0726664553293543, -2.2041558218411215, -1.3155257051873241, -2.2894903556911723, -0.9981696714983936, 1.0797642108878494, -1.3035884114135874, -2.274578913905548, -2.0073146312530072, -1.787755634023638, -2.142189577269809, -1.9268595483067228, -1.8916664291699599, 0.917598728926103, -1.7700265633644805, -1.1931492025833792, -1.105747119842614, -1.0523192782007078, -1.9165407866019564, -2.320485080063089, -1.8287167217722091, -1.974394178599863, -1.2708343385001608, -0.9860140276624831, -1.065670427379743, -1.940851754713563, -1.3549834220166228, -2.311175301072356, -1.836569263593745, -1.1916370243685903, -0.8180155108716396, 1.325945045011689, -1.7083032026559972, -2.0152088901827754, -2.29234657751442, -1.9361533399984452, -1.9805705484081262, -1.6725381265094186, -1.120895412898737, -0.8939261721988342, -1.6068432816767173, -1.3284946147625112, 1.4005525062801285, -1.394947860252782, -1.7871951307010492, -1.7830960845770003, -2.849984059850665, -1.1433231026242179, -1.611281146201099, -1.5588910857103655, -2.3911176436464405, -2.066995488456074, -2.03556841691878, -1.6777424383225874, -1.1561340044600332, 1.1272076935426176, -2.5054944562098713, -1.263601333990121, -2.7122168957873325, -1.4584465444498829, 1.8734231355946847, -2.3894197526672967, 2.5367511362864072, -1.4883076890205311, -2.6502907592339633, -2.2515445397403866, -1.8847434020805074, -2.1569070278537255, -2.13584236380081, -1.7322003645114399, -2.025313996760015, -1.4037057085024411, -1.1512306396744882, -1.5520600253987298, 1.9652122504449072, -1.6058125578158247, -1.2994083858682859, -1.9708128543161654, -2.90304674153703, -2.774848141972425, -2.4860686698860883, -2.2002150419542077, -1.882453446714373, -2.202283260232351, -2.1734458623066777, 0.9455978725867864, -1.7499258159316669, -1.8251647076461508, -1.947856673491689, -2.3670634658393266, -2.3649620973567487, -2.7061060721236547];
    const psi = [0, 2.552933556404281, 2.6542587846930448, -0.13745651085071733, 0.6938261652174003, -0.46989701564386394, 2.4303051695891575, 2.7336760626837, 1.8029521912357023, -0.5954276227641253, 2.431057400719837, 2.140693395739631, 2.2226751267892277, -0.3219245321973362, 0.27398466730913534, 0.10294200124718418, -0.5613834240742612, 2.9222791400641586, 2.4143295909023457, 2.386377586171963, 2.6494590783204357, 2.3614184229002517, 1.8780960727737321, 0.1303178127687694, -3.141082083731486, 0.2381183791471131, 2.4016952923430273, 2.6567854065844583, 2.1008047128279164, 2.433133225808281, 0.41614158198388, 2.3358304707823967, 0.28758034275034655, 2.8945476431702613, 2.675033851285499, 2.1169257848122713, 2.223100347914521, 2.075486359371908, 1.9538945892255768, 2.068169281178339, -2.3132955667549253, 0.3106508081261864, 2.902490098074891, 2.5213886563370496, 2.413869208807034, 2.4751324820110057, 2.226081173336723, 2.433904761465465, 2.256302221838545, 2.5463379012857588, 2.703812961465923, -0.42903277564323483, 0.39385743731435624, 2.399540668930801, 2.3256906702354807, 1.8720403759151607, 2.7275071063988796, 2.211923593111447, 0.011634701065377517, 2.8938826027679236, 2.6341283650077334, 2.39511092090646, 2.3064513017190444, 1.9108057932659601, 2.3512130532552336, 2.637923307625344, -0.5946141453842535, 0.1237773749898801, -0.21134706172734358, 0.21409275181800932, 2.7823256659442968, 2.3635633856621916, 2.6909242531452517, 1.7023840520400562, 2.5660041298418994, 0.1075455719949417, -0.5452474372228783, 2.0173775889601964, 2.780552552206733, 2.4750266685242988, 1.851544314916279, 2.3026510117182526, 0.6058083356315149, 1.9191346018577058, -0.4808621916533355, 2.800596193592895, -0.15413300238854502, 2.5906554753448914, 2.6062315333404538, -3.0222319004261915, -0.0882681786034027, 1.7903411615989464, 1.9359608576641933, 2.2115343446458384, 2.0705502189522775, 2.4324633937558247, 2.2388606580967525, 2.305372115061119, -3.099246397930023, -0.4122972941896536, -0.22905041252337885, 0.1614150104911723, 2.328477957302363, 2.123518679460422, -0.1341352804679804, 2.807898117854549, 2.7732854573407506, 2.278015943157839, 2.286120588014402, 2.1941521452189834, 2.49993023623977, 2.625804282660541, 1.0111998031245781, 2.346694025075673, 2.1082927759147285, 2.4781547247059943, 2.7629621369988313, 1.9242876403552769, 0];
    const residues = ['Start', 'SER', 'THR', 'SER', 'GLY', 'ARG', 'VAL', 'ALA', 'VAL', 'GLU', 'GLU', 'VAL', 'ASP', 'GLU', 'GLU', 'GLY', 'LYS', 'PHE', 'VAL', 'ARG', 'LEU', 'ARG', 'ASN', 'LYS', 'SER', 'ASN', 'GLU', 'ASP', 'GLN', 'SER', 'MET', 'GLY', 'ASN', 'TRP', 'GLN', 'ILE', 'LYS', 'ARG', 'GLN', 'ASN', 'GLY', 'ASP', 'ASP', 'PRO', 'LEU', 'LEU', 'THR', 'TYR', 'TRP', 'PHE', 'PRO', 'PRO', 'LYS', 'PHE', 'THR', 'LEU', 'LYS', 'ALA', 'GLY', 'GLN', 'VAL', 'VAL', 'THR', 'ILE', 'TRP', 'ALA', 'ALA', 'GLY', 'ALA', 'GLY', 'ALA', 'THR', 'HIS', 'SER', 'PRO', 'PRO', 'THR', 'ASP', 'LEU', 'VAL', 'TRP', 'LYS', 'ALA', 'GLN', 'ASN', 'THR', 'TRP', 'GLY', 'CSD', 'GLY', 'ASN', 'SER', 'LEU', 'ARG', 'THR', 'ALA', 'LEU', 'ILE', 'ASN', 'SER', 'THR', 'GLY', 'GLU', 'GLU', 'VAL', 'ALA', 'MET', 'ARG', 'LYS', 'LEU', 'VAL', 'ARG', 'SER', 'VAL', 'THR', 'VAL', 'VAL', 'GLU', 'ASP'];
    const phi_deg = phi.map(rad => rad * 180 / Math.PI);
    const psi_deg = psi.map(rad => rad * 180 / Math.PI);
    console.log(phi_deg);
    console.log(psi_deg);
	  
    function sliceData(residue_n) {
      return {
	      x: phi_deg.slice(0, residue_n),
	      y: psi_deg.slice(0, residue_n),
	      labels: residues.slice(0, residue_n)
      };
    }

    // Background nach kanonischer Auswahl
    function canonicalBackground () {
	return Array.from(document.querySelectorAll('input[name="canonical_bg"]:checked')).map(cb => cb.value);
    }
    

    // Plotly-Grafik
    function updatePlot(n) {
      let data = sliceData(n);
      
      const imgCanonicalBackground = canonicalBackground();
      console.log("Array contents:", imgCanonicalBackground);
      const canonicalBackgroundImages = imgCanonicalBackground.map(idx => ({
	    source: `images/bg${idx}.png`,
	    xref: "x",
	    yref: "y",
	    x: 0,
	    y: 1,
	    sizex: 1,
	    sizey: 1,
	    sizing: "stretch",
	    opacity: 0.9,
	    layer: "below"
      }));

      let layout = {
	width: 600,
	height: 600,
	xaxis: { range: [-180, 180], scaleanchor: 'y', scaleratio: 1, title: 'ϕ (phi)' },
	yaxis: { range: [-180, 180], title: 'ψ (psi)' },
	images: canonicalBackgroundImages
      };
      
      
      Plotly.newPlot('plot', [{
        x: data.x,
        y: data.y,
        mode: 'markers',
        type: 'scatter',
	text: data.labels,
  	hovertemplate: '%{text}<br>x: %{x}<br>y: %{y}<extra></extra>',
	marker: { size: 10, color: "red" }
      }], layout);
    }
	
    // Initialer Plot
    updatePlot(2);
	  
    // Event-Listener: Slider-Event
    const slider = document.getElementById('slider');
    const sliderValue = document.getElementById('slider-value');
    slider.min = 0;
    slider.max = 118;

    document.getElementById('slider').addEventListener('input',
        function () {
           let residue_n = document.getElementById('slider').value;
	   sliderValue.textContent = residue_n;
           updatePlot(residue_n);
        });


    // Event-Listener: Background-Image
    document.getElementById('canonical-checkboxes').addEventListener('input',
	function() {
	   let residues = document.getElementById('slider').value;
      	   updatePlot(residues);
	});
  </script>


</body>
</html>
